<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Controle de Avarias</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>

<style>
    body { font-family: Arial; margin: 20px; }
    input, select { width: 100%; padding: 10px; font-size: 18px; margin-top: 5px; }
    button { width: 100%; padding: 12px; margin-top: 15px; font-size: 18px; }
    #scanner-container { 
        width: 100%; 
        height: 300px; 
        border: 2px solid #444; 
        margin-top: 15px; 
        display: none; 
        position: relative;
    }
    #scanner-container video {
        width: 100%; 
        height: 100%; 
        object-fit: cover;
    }
</style>

</head>
<body>

<h2> Controle de Avarias</h2>

<label>C贸digo do Produto</label>
<input id="codigo" placeholder="Escaneie o c贸digo">

<button onclick="abrirScanner()"> Ler C贸digo de Barras</button>

<div id="scanner-container"></div>

<label>Responsabilidade</label>
<select id="responsavel">
    <option value="">Selecione...</option>
    <option value="Whirlpool">Whirlpool</option>
    <option value="Venkon">Venkon</option>
</select>

<label>Tipo da Avaria</label>
<select id="tipo">
    <option value="">Selecione...</option>
    <option value="Embalagem">Embalagem</option>
    <option value="Produto">Produto</option>
</select>

<button onclick="salvar()"> Salvar</button>

<h3>Registros</h3>
<div id="registros"></div>

<script>
function abrirScanner() {
    const container = document.getElementById("scanner-container");
    container.style.display = "block";

    Quagga.init({
        inputStream: {
            type: "LiveStream",
            target: container,
            constraints: {
                facingMode: "environment"  // c芒mera traseira
            }
        },
        decoder: {
            readers: ["code_128_reader", "code_39_reader", "ean_reader"]
        }
    }, function(err) {
        if (err) {
            alert("Erro ao acessar a c芒mera: " + err);
            return;
        }
        Quagga.start();
    });

    Quagga.onDetected(function(result) {
        document.getElementById("codigo").value = result.codeResult.code;

        Quagga.stop();
        container.style.display = "none";
    });
}

function salvar() {
    const c = document.getElementById("codigo").value;
    const r = document.getElementById("responsavel").value;
    const t = document.getElementById("tipo").value;

    if (!c || !r || !t) {
        alert("Preencha tudo!");
        return;
    }

    let div = document.createElement("div");
    div.style.marginTop = "10px";
    div.innerHTML = `
        <strong>C贸digo:</strong> ${c}<br>
        <strong>Respons谩vel:</strong> ${r}<br>
        <strong>Avaria:</strong> ${t}<br><hr>
    `;
    document.getElementById("registros").appendChild(div);

    document.getElementById("codigo").value = "";
    document.getElementById("responsavel").value = "";
    document.getElementById("tipo").value = "";
}
</script>

</body>
</html>


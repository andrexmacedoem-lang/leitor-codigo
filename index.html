<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Controle de Avarias</title>

<style>
    body { font-family: Arial; padding: 20px; }
    input, select, button {
        width: 100%; padding: 12px; margin: 8px 0; font-size: 18px;
    }
    #camera-area { display: none; }
    #camera { width: 100%; border-radius: 10px; }
    #registros div { padding: 10px; border: 1px solid #ccc; margin-top: 10px; }
</style>

<!-- CARREGA QUAGGAJS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>

<script>
function iniciarLeitura() {
    document.getElementById("camera-area").style.display = "block";

    Quagga.init({
        inputStream: {
            name: "Live",
            type: "LiveStream",
            target: document.querySelector("#camera"), 
            constraints: {
                facingMode: "environment"
            }
        },
        decoder: {
            readers: [
                "code_128_reader",   // Whirlpool usa isso!
                "ean_reader",
                "ean_8_reader",
                "code_39_reader",
                "code_93_reader",
                "upc_reader"
            ]
        }
    }, function(err) {
        if (err) {
            alert("Erro ao iniciar c芒mera: " + err);
            return;
        }
        Quagga.start();
    });

    Quagga.onDetected(function(result) {
        let codigo = result.codeResult.code;
        document.getElementById("codigo").value = codigo;
        pararLeitura();
    });
}

function pararLeitura() {
    Quagga.stop();
    document.getElementById("camera-area").style.display = "none";
}

function salvar() {
    let codigo = document.getElementById("codigo").value;
    let resp = document.getElementById("responsavel").value;
    let tipo = document.getElementById("tipo").value;

    if (!codigo || !resp || !tipo) {
        alert("Preencha todos os campos.");
        return;
    }

    let bloco = document.createElement("div");
    bloco.innerHTML = `
        <strong>C贸digo:</strong> ${codigo}<br>
        <strong>Respons谩vel:</strong> ${resp}<br>
        <strong>Tipo:</strong> ${tipo}
    `;
    document.getElementById("registros").appendChild(bloco);

    document.getElementById("codigo").value = "";
    document.getElementById("responsavel").value = "";
    document.getElementById("tipo").value = "";
}
</script>
</head>

<body>

<h2> Controle de Avarias</h2>

<label>C贸digo do Produto</label>
<input id="codigo" placeholder="Escaneie o c贸digo de barras">

<button onclick="iniciarLeitura()"> Ler C贸digo de Barras</button>

<div id="camera-area">
    <div id="camera"></div>
    <button onclick="pararLeitura()" style="background:#d33;color:white;">Fechar C芒mera</button>
</div>

<label>Responsabilidade</label>
<select id="responsavel">
    <option value="">Selecione...</option>
    <option value="Whirlpool">Whirlpool</option>
    <option value="Venkon">Venkon</option>
</select>

<label>Tipo da Avaria</label>
<select id="tipo">
    <option value="">Selecione...</option>
    <option value="Embalagem">Embalagem</option>
    <option value="Produto">Produto</option>
</select>

<button onclick="salvar()"> Salvar</button>

<h3>Registros salvos</h3>
<div id="registros"></div>

</body>
</html>





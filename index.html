<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Controle de Avarias</title>

<style>
    body { font-family: Arial; margin: 20px; }
    label { font-weight: bold; }
    button { margin-top: 10px; padding: 12px; font-size: 18px; width: 100%; }
    iframe { width: 100%; height: 450px; border: none; display: none; }
    #registros div { 
        background:#f0f0f0; padding:10px; margin-top:10px; border-radius:8px; 
    }
</style>
</head>
<body>

<h2> Controle de Avarias</h2>

<label>C贸digo do Produto</label>
<input type="text" id="codigo" style="width:100%; padding:8px; font-size:18px;" placeholder="Escaneie o c贸digo">

<button onclick="abrirLeitor()"> Ler C贸digo de Barras</button>

<!-- Leitor com c芒mera correta -->
<iframe id="scanner"></iframe>

<br><br>

<label>Responsabilidade</label>
<select id="responsavel" style="width:100%; padding:8px; font-size:16px;">
    <option value="">Selecione...</option>
    <option value="Whirlpool">Whirlpool</option>
    <option value="Venkon">Venkon</option>
</select>

<br><br>

<label>Tipo de Avaria</label>
<select id="tipo" style="width:100%; padding:8px; font-size:16px;">
    <option value="">Selecione...</option>
    <option value="Embalagem">Embalagem</option>
    <option value="Produto">Produto</option>
</select>

<br><br>

<button onclick="salvarRegistro()"> Salvar</button>

<h3>Registros Salvos</h3>
<div id="registros"></div>

<script>
// abre o leitor ZXing COM CMERA
function abrirLeitor() {
    const frame = document.getElementById("scanner");

    frame.src = "https://zxing.org/w/scanner";  // ESTA  A URL CERTA DA CMERA
    frame.style.display = "block";

    window.addEventListener("message", function (e) {
        if (e.data && e.data.result) {
            document.getElementById("codigo").value = e.data.result.text;
            frame.style.display = "none";
        }
    });
}

function salvarRegistro() {
    const codigo = document.getElementById("codigo").value;
    const resp = document.getElementById("responsavel").value;
    const tipo = document.getElementById("tipo").value;

    if (!codigo || !resp || !tipo) {
        alert("Preencha todos os campos.");
        return;
    }

    const div = document.createElement("div");
    div.innerHTML = `
        <strong>C贸digo:</strong> ${codigo}<br>
        <strong>Respons谩vel:</strong> ${resp}<br>
        <strong>Avaria:</strong> ${tipo}
    `;

    document.getElementById("registros").appendChild(div);

    document.getElementById("codigo").value = "";
    document.getElementById("responsavel").value = "";
    document.getElementById("tipo").value = "";
}
</script>

</body>
</html>


